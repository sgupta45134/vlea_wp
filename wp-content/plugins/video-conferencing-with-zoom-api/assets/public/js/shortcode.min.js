"use strict";!function(r){var e={init:function(){this.cacheDOM(),this.defaultActions()},cacheDOM:function(){if(this.$wrapper=r(".vczapi-user-meeting-list"),void 0===this.$wrapper||this.$wrapper.length<1)return!1},defaultActions:function(){this.$wrapper.DataTable({responsive:!0,language:vczapi_dt_i18n})}},i={paginationHandler:function(){r(document).on("click",".vczapi-list-zoom-meetings--pagination .page-numbers",function(e){e.preventDefault();var i=r(e.target),t=i.parents(".vczapi-list-zoom-meetings"),a=parseInt(i.text()),n=t.data(),e=1;i.hasClass("next")?(e=t.find(".vczapi-list-zoom-meetings--pagination").find(".page-numbers.current"),a=parseInt(e.next().text())):i.hasClass("prev")&&(e=t.find(".vczapi-list-zoom-meetings--pagination").find(".page-numbers.current"),a=parseInt(e.prev().text())),n.page_num=a;a=t.find("form.vczapi-filters").serializeArray().reduce(function(e,i){return e[i.name]=i.value,e},{});r.ajax({type:"POST",url:vczapi_ajax.ajaxurl,data:{action:"vczapi_list_meeting_shortcode_ajax_handler",data:n,form_data:a},beforeSend:function(){t.addClass("loading")},success:function(e){t.removeClass("loading"),t.find(".vczapi-items-wrap").html(e.content),t.find(".vczapi-list-zoom-meetings--pagination").html(e.pagination)},error:function(){}})})},filterFormSubmitHandler:function(){r("form.vczapi-filters").on("submit",function(e){e.preventDefault();var i=r(this).parents(".vczapi-list-zoom-meetings"),t=r(this).serializeArray().reduce(function(e,i){return e[i.name]=i.value,e},{}),e=i.data();e.page_num=1,r.ajax({type:"POST",url:vczapi_ajax.ajaxurl,data:{action:"vczapi_list_meeting_shortcode_ajax_handler",data:e,form_data:t},beforeSend:function(){i.addClass("loading")},success:function(e){i.removeClass("loading"),i.find(".vczapi-items-wrap").html(e.content),i.find(".vczapi-list-zoom-meetings--pagination").html(e.pagination)},error:function(){}})})},filterOnChangeHandler:function(){r("form.vczapi-filters").find("select").on("change",function(e){e.preventDefault(),r(this).parents("form.vczapi-filters").submit()})},eventListeners:function(){this.paginationHandler(),this.filterOnChangeHandler(),this.filterFormSubmitHandler()},init:function(){this.eventListeners()}},t={init:function(){this.cacheDOM(),this.evntHandlers()},cacheDOM:function(){this.$recordingsDatePicker=r(".vczapi-check-recording-date")},evntHandlers:function(){r(document).on("click",".vczapi-view-recording",this.openModal.bind(this)),r(document).on("click",".vczapi-modal-close",this.closeModal.bind(this)),0<r(".vczapi-recordings-list-table").length&&r(".vczapi-recordings-list-table").DataTable({responsive:!0,language:vczapi_dt_i18n,order:[3,"desc"],columnDefs:[{orderable:!1,targets:[2,5]}]}),0<r(this.$recordingsDatePicker).length&&this.$recordingsDatePicker.datepicker({changeMonth:!0,changeYear:!0,showButtonPanel:!0,dateFormat:"MM yy",beforeShow:function(e,i){setTimeout(function(){i.dpDiv.css({top:r(".vczapi-check-recording-date").offset().top+35,left:r(".vczapi-check-recording-date").offset().left})},0)}}).focus(function(){var t=r(this);r(".ui-datepicker-calendar").detach(),r(".ui-datepicker-close").click(function(){var e=r("#ui-datepicker-div .ui-datepicker-month :selected").val(),i=r("#ui-datepicker-div .ui-datepicker-year :selected").val();t.datepicker("setDate",new Date(i,e,1))})})},closeModal:function(e){e.preventDefault(),r(".vczapi-modal-content").remove(),r(".vczapi-modal").hide()},openModal:function(e){e.preventDefault();e={recording_id:r(e.currentTarget).data("recording-id"),action:"get_recording",downlable:vczapi_recordings_data.downloadable};r(".vczapi-modal").html('<p class="vczapi-modal-loader">'+vczapi_recordings_data.loading+"</p>").show(),r.get(vczapi_ajax.ajaxurl,e).done(function(e){r(".vczapi-modal").html(e.data).show()})}};r(function(){i.init(),e.init(),t.init()})}(jQuery);